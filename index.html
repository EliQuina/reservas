<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <title>Document</title>
</head>
<style>
    body {
        background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.5), rgba(0, 0, 0, 0.5)), url(https://s1.1zoom.me/big0/807/357828-admin.jpg);
        background-size: cover;
        background-position: center;
        color: white;
    }
</style>
<body style="margin: 40px;">
    <h1>GESTION DE RESERVAS</h1>
    <hr>
    <div class="row">
        <div class="col-md-3">
            <form id="form-product">
                <input type="hidden" id="id" name="id">
                <b>Nombres: </b>
                <br>
                <input style="border-radius: 10px;" type="text" id="nombres" name="nombres" placeholder="Nombres">
                <br>
                <!-- Otras entradas de formulario aquí... -->
                <br>
                <button type="submit" class="btn btn-outline-info" id="btnAgregar">Agregar Reserva</button>
                <!-- Cambié el ID del botón Actualizar a btnActualizar y lo mantuve oculto por defecto -->
                <button type="button" class="btn btn-outline-success d-none" id="btnActualizar">Actualizar Reserva</button>
            </form>
        </div>
        <div class="col-md-9">
            <table id="empleados-table" class="table">
                <thead>
                    <tr>
                        <!-- Encabezados de tabla aquí... -->
                    </tr>
                </thead>
                <tbody id="reservas-body"></tbody>
            </table>
        </div>
    </div>
</body>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, updateDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"

    const firebaseConfig = {
        apiKey: "TuClaveApiFirebase",
        authDomain: "hotel-2a939.firebaseapp.com",
        projectId: "hotel-2a939",
        storageBucket: "hotel-2a939.appspot.com",
        messagingSenderId: "342922590938",
        appId: "1:342922590938:web:b86f4304821e21f3a983e3"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const productform = document.getElementById("form-product");
    const reservasBody = document.getElementById("reservas-body");
    const btnAgregar = document.getElementById("btnAgregar");
    const btnActualizar = document.getElementById("btnActualizar");

    productform.addEventListener("submit", async (e) => {
        e.preventDefault();

        if (btnActualizar.classList.contains("d-none")) {
            await addDoc(collection(db, "reservas"), {
                // Datos del formulario aquí...
            });
        } else {
            const id = productform.id.value;
            await updateDoc(doc(db, "reservas", id), {
                // Datos del formulario aquí...
            });
            // Después de actualizar, volvemos a mostrar el botón Agregar y ocultamos Actualizar
            btnAgregar.classList.remove("d-none");
            btnActualizar.classList.add("d-none");
        }
        productform.reset();
    });

    onSnapshot(collection(db, "reservas"), (querySnapshot) => {
        reservasBody.innerHTML = "";
        querySnapshot.forEach((doc) => {
            const reserva = doc.data();
            const row = document.createElement("tr");
            row.innerHTML = `
                <!-- Celdas de la fila aquí... -->
                <td>
                    <button class="btn btn-outline-primary btn-editar" data-id="${doc.id}">Editar</button>
                    <button class="btn btn-outline-danger btn-eliminar" data-id="${doc.id}">Eliminar</button>
                </td>
            `;
            reservasBody.appendChild(row);
        });

        document.querySelectorAll(".btn-editar").forEach(btn => {
            btn.addEventListener("click", async (e) => {
                const id = e.target.getAttribute("data-id");
                const reservaDoc = await getDoc(doc(db, "reservas", id));
                const reservaData = reservaDoc.data();
                // Llenamos el formulario con los datos de la reserva seleccionada para editar
                productform.id.value = id;
                productform.nombres.value = reservaData.nombres;
                // Otros campos del formulario aquí...
                // Cambiamos la visibilidad de los botones Agregar y Actualizar
                btnAgregar.classList.add("d-none");
                btnActualizar.classList.remove("d-none");
            });
        });

        document.querySelectorAll(".btn-eliminar").forEach(btn => {
            btn.addEventListener("click", async (e) => {
                const id = e.target.getAttribute("data-id");
                await deleteDoc(doc(db, "reservas", id));
            });
        });
    });
</script>
</html>
